(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{219:function(e,t,n){},233:function(e,t){},284:function(e,t){},286:function(e,t){},295:function(e,t){},297:function(e,t){},323:function(e,t){},324:function(e,t){},329:function(e,t){},331:function(e,t){},338:function(e,t){},351:function(e,t){},520:function(e,t,n){"use strict";n.r(t);var r=n(13),a=n.n(r),c=n(211),i=n.n(c),s=(n(219),n(19)),o=n(7),l=n.n(o),d=n(212),u=n(213),b=n.n(u),j=n(214),h=n.n(j),f=n(54),p=n.n(f),m=n(1),O=function(){return Object(m.jsx)("nav",{className:"navbar navbar-expand-md navbar-light bg-light fixed-top",children:Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("a",{className:"navbar-brand",href:"https://rifos.org",target:"_blank",rel:"noreferrer",children:Object(m.jsx)("img",{src:"https://rifos.org/assets/img/logo.svg",className:"logo",alt:"logo"})}),Object(m.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarsExampleDefault","aria-controls":"navbarsExampleDefault","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(m.jsx)("span",{className:"navbar-toggler-icon"})}),Object(m.jsx)("div",{className:"collapse navbar-collapse",id:"navbarsExampleDefault",children:Object(m.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(m.jsx)("li",{className:"nav-item",children:Object(m.jsx)("a",{className:"nav-link",href:"https://developers.rsk.co/rif/identity",target:"_blank",rel:"noreferrer",children:"RIF Identity docs"})}),Object(m.jsx)("li",{className:"nav-item",children:Object(m.jsx)("a",{className:"nav-link",href:"https://github.com/rsksmart/email-vc-issuer",target:"_blank",rel:"noreferrer",children:"Github"})}),Object(m.jsx)("li",{className:"nav-item",children:Object(m.jsx)("a",{className:"nav-link",href:"https://developers.rsk.co/rif/identity/about",target:"_blank",rel:"noreferrer",children:"Contact"})})]})})]})})},g="https://email-vc-issuer.staging.rifcomputing.net",v=new b.a({cachedProvider:!1,providerOptions:{walletconnect:{package:h.a,options:{rpc:{1:"https://mainnet.infura.io/v3/8043bb2cf99347b1bfadfb233c5325c0",30:"https://public-node.rsk.co",31:"https://public-node.testnet.rsk.co"}}}},supportedChains:[31]}),x=function(e){return function(t){return e(t.target.value)}},y=function(e){return"did:ethr:rsk:testnet:".concat(e)},N=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMetaMask||t.isNiftyWallet){e.next=4;break}return e.next=3,f.AsymmetricEncryptionManager.fromWeb3Provider(t);case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,f.SignerEncryptionManager.fromWeb3Provider(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var k=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),i=Object(s.a)(c,2),o=i[0],l=i[1],d=Object(r.useState)(null),u=Object(s.a)(d,2),b=u[0],j=u[1],h=Object(r.useState)(""),k=Object(s.a)(h,2),S=k[0],w=k[1],C=Object(r.useState)(""),E=Object(s.a)(C,2),M=E[0],I=E[1],P=Object(r.useState)(!1),V=Object(s.a)(P,2),_=V[0],q=V[1],F=Object(r.useState)(""),T=Object(s.a)(F,2),D=T[0],W=T[1],J=Object(r.useState)(""),R=Object(s.a)(J,2),A=R[0],U=R[1],B=Object(r.useState)(!1),G=Object(s.a)(B,2),L=G[0],z=G[1],H=S?y(S):"",K=function(e){return a(e?e.message:"Unhandled error")};return Object(m.jsxs)("div",{children:[Object(m.jsx)(O,{}),Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col",children:[Object(m.jsx)("h1",{children:"Email VC Issuer"}),n&&Object(m.jsxs)("p",{className:"error",children:["Error: ",n]}),Object(m.jsx)("h3",{children:"1. Enable wallet"}),Object(m.jsx)("button",{onClick:function(){return v.connect().then((function(e){var t=e.provider;l(t),t.request({method:"eth_accounts"}).then((function(e){w(e[0]);var n=y(e[0]),r=function(n){return t.request({method:"personal_sign",params:[n,e[0]]})},a="https://identity-data-vault.testnet.rifos.org";return N(t).then((function(e){var t=new p.a({authManager:new f.AuthManager({did:n,serviceUrl:a,personalSign:r}),encryptionManager:e,serviceUrl:a});j(t)}))}))})).catch(K)},className:"btn btn-primary",children:"enable"}),Object(m.jsx)("p",{children:S}),Object(m.jsx)("p",{children:H})," ",Object(m.jsx)("h3",{children:"2. Request email verification"}),Object(m.jsxs)("div",{className:"input-group",children:[Object(m.jsx)("input",{type:"email",value:M,onChange:x(I),disabled:!S,placeholder:"Email address",className:"form-control"}),Object(m.jsx)("div",{className:"input-group-append",children:Object(m.jsx)("button",{id:"request",onClick:function(){return fetch("".concat(g,"/requestVerification/")+H,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({emailAddress:M})}).then((function(){q(!0)})).catch(K)},disabled:!S,className:"btn btn-primary",children:"request"})})]}),Object(m.jsx)("p",{children:_&&"Email sent"}),Object(m.jsx)("h3",{children:"3. Verify your email"}),Object(m.jsxs)("div",{className:"input-group",children:[Object(m.jsx)("input",{type:"text",value:D,onChange:x(W),disabled:!_,placeholder:"Verification code",className:"form-control"}),Object(m.jsx)("div",{className:"input-group-append",children:Object(m.jsx)("button",{onClick:function(){return o.request({method:"personal_sign",params:["Verification code: ".concat(D),S]}).then((function(e){return fetch("".concat(g,"/verify/")+H,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({sig:e})})})).then((function(e){return e.json()})).then((function(e){var t=e.jwt;U(t)})).catch(K)},disabled:!_,className:"btn btn-primary",children:"verify"})})]}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:A}),Object(m.jsx)("h3",{children:"4. Store it in your Data Vault"}),Object(m.jsx)("button",{onClick:function(){return b.create({key:"EmailVerifiableCredential",content:A}).then((function(){z(!0)})).catch(K)},disabled:!A,className:"btn btn-primary",children:"save"}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:L&&"Saved!"}),Object(m.jsx)("h3",{children:"5. Validate in RIF Id Manager"}),Object(m.jsxs)("p",{children:["Go to the ",Object(m.jsx)("a",{href:"https://rsksmart.github.io/rif-identity-manager/",target:"_blank",rel:"noreferrer",children:"RIF Identity Manager"})]})]})})})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,523)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};i.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(k,{})}),document.getElementById("root")),S()}},[[520,1,2]]]);
//# sourceMappingURL=main.b807a5a6.chunk.js.map